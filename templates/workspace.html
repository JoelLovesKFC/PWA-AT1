{% extends "base.html" %}
{% block title %}Workspace • {{ ws.name }}{% endblock %}

{% block head_extra %}
<meta name="csrf-token" content="{{ csrf_token() }}">
<style>
    .ws-wrap {
        margin-top: 1rem
    }

    .ws-card {
        background: #fff;
        border: 1px solid var(--bs-border-color);
        border-radius: .5rem
    }

    .notes-list {
        max-height: calc(100vh - 180px);
        overflow: auto
    }

    .note-item {
        padding: .6rem .75rem;
        border-bottom: 1px solid var(--bs-border-color);
        cursor: pointer
    }

    .note-item.active {
        background: #f6f7f9
    }

    .note-item h6 {
        margin: 0;
        font-size: .95rem
    }

    .note-item small {
        color: var(--bs-secondary-color)
    }

    .editor-header {
        display: flex;
        gap: .5rem;
        align-items: center
    }

    .editor-title {
        font-size: 1rem
    }

    .editor-area {
        min-height: 55vh;
        border: 1px solid var(--bs-border-color);
        border-radius: .5rem;
        padding: .75rem
    }

    .status-dot {
        font-size: .75rem
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid ws-wrap" id="wsRoot" data-ws-id="{{ ws.id }}" data-csrf="{{ csrf_token() }}">
    <div class="row g-3">
        <div class="col-12 col-lg-3">
            <div class="ws-card p-2">
                <div class="d-flex justify-content-between align-items-center px-2 py-2">
                    <h2 class="h6 mb-0">Notes in “{{ ws.name }}”</h2>
                    <button id="newNoteBtn" class="btn btn-sm btn-primary">
                        <i class="bi bi-plus-lg me-1"></i>New
                    </button>
                </div>
                <div id="notesList" class="notes-list"></div>
            </div>
        </div>

        <div class="col-12 col-lg-9">
            <div class="ws-card p-3">
                <div class="editor-header mb-2">
                    <input id="noteTitle" class="form-control editor-title" placeholder="Untitled">
                    <div class="ms-auto small text-secondary" id="saveState">
                        <span class="status-dot">●</span> Idle
                    </div>
                    <button id="deleteNoteBtn" class="btn btn-sm btn-outline-danger d-none">
                        <i class="bi bi-trash me-1"></i>Delete
                    </button>
                </div>
                <textarea id="noteBody" class="form-control editor-area" placeholder="Start typing…"></textarea>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts_extra %}
<script src="{{ url_for('static', filename='js/workspace_notes.js') }}"></script>
{% endblock %}